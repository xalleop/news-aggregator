# Новостной Агрегатор на RSS

Автоматизированный сбор и фильтрация новостей из RSS-фидов с последующим анализом через Claude.

## Возможности

- ✅ Автоматический сбор новостей из RSS-фидов (3 раза в день)
- ✅ Фильтрация по ключевым словам
- ✅ Группировка по источникам и темам
- ✅ Генерация структурированных JSON и читаемых текстовых отчетов
- ✅ Полностью бесплатное размещение на GitHub Actions
- ✅ Без необходимости в API ключах

## Структура проекта

```
news-aggregator/
├── feeds.yaml              # Конфигурация RSS-фидов
├── criteria.yaml           # Критерии оценки значимости
├── news_agent.py           # Основной скрипт
├── requirements.txt        # Зависимости Python
├── .github/
│   └── workflows/
│       └── news-monitor.yml  # Автоматизация
└── reports/                # Папка для отчетов (создается автоматически)
    ├── raw_articles_*.json      # Сырые данные
    ├── raw_digest_*.txt         # Текстовые отчеты
    ├── summary_*.json           # Краткие сводки
    └── latest.txt               # Последний отчет
```

## Пошаговая инструкция по установке

### Шаг 1: Создание репозитория на GitHub

1. Войдите в свой GitHub аккаунт
2. Нажмите кнопку "+" в правом верхнем углу → "New repository"
3. Укажите имя репозитория: `news-aggregator`
4. Выберите **Public** (для бесплатного использования GitHub Actions)
5. Отметьте галочку "Add a README file"
6. Нажмите "Create repository"

### Шаг 2: Загрузка файлов в репозиторий

**Вариант A: Через веб-интерфейс GitHub**

1. В вашем репозитории нажмите "Add file" → "Upload files"
2. Перетащите следующие файлы:
   - `feeds.yaml`
   - `criteria.yaml`
   - `news_agent.py`
   - `requirements.txt`
3. Нажмите "Commit changes"
4. Создайте папку `.github/workflows/`:
   - Нажмите "Add file" → "Create new file"
   - В поле имени файла введите: `.github/workflows/news-monitor.yml`
   - Вставьте содержимое файла `news-monitor.yml`
   - Нажмите "Commit changes"

**Вариант B: Через git (командная строка)**

```bash
# Клонируйте репозиторий
git clone https://github.com/ваш-username/news-aggregator.git
cd news-aggregator

# Скопируйте все файлы проекта в эту папку
# (feeds.yaml, criteria.yaml, news_agent.py, requirements.txt, .github/workflows/news-monitor.yml)

# Добавьте файлы в git
git add .
git commit -m "Initial commit: News aggregator setup"
git push origin main
```

### Шаг 3: Настройка списка RSS-фидов

Откройте файл `feeds.yaml` в редакторе:

**Добавление нового источника:**

```yaml
tech_news:
  Название_Источника:
    url: "https://example.com/rss.xml"
    enabled: true
    tags: ["tech", "ai"]
```

**Отключение источника:**

```yaml
  Медуза:
    url: "https://meduza.io/rss/all"
    enabled: false  # Просто поставьте false
```

**Изменение фильтров:**

```yaml
filters:
  keywords:
    - "новое ключевое слово"
    - "другая тема"
  
  exclude_keywords:
    - "слово для исключения"
  
  hours_back: 24  # Период сбора (часов)
```

**Сохраните изменения:**

```bash
git add feeds.yaml
git commit -m "Update RSS feeds configuration"
git push
```

### Шаг 4: Настройка критериев оценки значимости

Откройте файл `criteria.yaml`:

**Изменение весов категорий:**

```yaml
categories:
  regulatory_changes:
    weight: 10  # Измените вес (1-10)
    description: "Ваше описание"
```

**Добавление новой категории:**

```yaml
  your_new_category:
    weight: 8
    description: "Описание новой категории"
    examples:
      - "Пример 1"
      - "Пример 2"
```

**Изменение примеров для калибровки:**

```yaml
examples:
  high_significance:
    - title: "Название новости"
      score: 9
      rationale: "Почему важно"
      category: "regulatory_changes"
```

Эти критерии используются при ручном анализе через Claude.

### Шаг 5: Настройка расписания запуска

Откройте `.github/workflows/news-monitor.yml`:

**Текущая настройка (3 раза в день):**

```yaml
schedule:
  - cron: '0 6 * * *'   # 09:00 МСК
  - cron: '0 12 * * *'  # 15:00 МСК
  - cron: '0 18 * * *'  # 21:00 МСК
```

**Изменение частоты:**

```yaml
# Каждый час с 6 до 20 UTC (9-23 МСК)
- cron: '0 6-20 * * *'

# 2 раза в день
- cron: '0 6 * * *'   # Утро
- cron: '0 18 * * *'  # Вечер

# 5 раз в день
- cron: '0 6,9,12,15,18 * * *'

# Только по будням в рабочие часы
- cron: '0 6-18 * * 1-5'
```

**Важно:** Время указывается в UTC (для Москвы вычтите 3 часа)

### Шаг 6: Тестирование

**Проверка локально (на своем компьютере):**

```bash
# Установите Python 3.11+
python3 --version

# Установите зависимости
pip install -r requirements.txt

# Запустите агент
python news_agent.py

# Проверьте результаты
ls reports/
cat reports/latest.txt
```

**Тестирование на GitHub:**

1. Перейдите в ваш репозиторий на GitHub
2. Откройте вкладку "Actions"
3. Слева выберите "News Aggregator"
4. Нажмите "Run workflow" → "Run workflow"
5. Подождите 2-3 минуты
6. Проверьте результаты:
   - Зеленая галочка = успех
   - Красный крестик = ошибка (кликните для просмотра логов)

**Просмотр результатов:**

1. В workflow нажмите на завершенный запуск
2. Скачайте "Artifacts" → `news-reports-XXX.zip`
3. Или проверьте папку `reports/` в репозитории

## Использование

### Автоматический режим

После настройки GitHub Actions агент будет работать автоматически по расписанию:

1. Собирает новости из RSS-фидов
2. Фильтрует по ключевым словам
3. Группирует по источникам и темам
4. Сохраняет отчеты в папку `reports/`
5. Коммитит результаты в репозиторий

### Ручной анализ через Claude

1. Скачайте файл `reports/raw_articles_[дата].json`
2. Откройте чат с Claude на claude.ai
3. Загрузите оба файла:
   - `raw_articles_[дата].json`
   - `criteria.yaml`
4. Напишите промпт:

```
Проанализируй эти новости используя критерии из criteria.yaml.

Задачи:
1. Сгруппируй статьи по темам (4-8 тематических кластеров)
2. Оцени значимость каждой темы по шкале 1-10 согласно критериям
3. Отсортируй по убыванию значимости
4. Для каждой темы создай:
   - Краткое название темы
   - Оценку значимости с обоснованием
   - Резюме (2-3 предложения)
   - Список релевантных статей с URLs

Формат ответа: создай текстовый отчет с четкой структурой.
```

5. Claude создаст структурированный отчет с анализом
6. Сохраните результат как `analyzed_digest_[дата].txt`

### Просмотр отчетов

**Быстрый просмотр последнего отчета:**

```bash
cat reports/latest.txt
```

**Все отчеты:**

```bash
ls reports/
# raw_articles_2024-02-14_09-00.json  - данные
# raw_digest_2024-02-14_09-00.txt     - текстовый отчет
# summary_2024-02-14_09-00.json       - краткая сводка
```

**Онлайн (в репозитории):**

Перейдите в папку `reports/` на GitHub → откройте `latest.txt`

## Устранение проблем

### Агент не запускается автоматически

1. Проверьте вкладку "Actions" → должен быть включен
2. Репозиторий должен быть Public (или есть минуты на Private)
3. Проверьте синтаксис в `news-monitor.yml`

### Нет новостей после фильтрации

1. Проверьте ключевые слова в `feeds.yaml`
2. Увеличьте `hours_back` (например, до 48)
3. Временно уберите ключевые слова для проверки

### Ошибки при парсинге RSS

1. Проверьте URL фидов (должны быть рабочие)
2. Некоторые RSS могут блокировать GitHub IP
3. Попробуйте отключить проблемные источники

### Git push failed

Это нормально если нет изменений. Строка `continue-on-error: true` предотвращает падение workflow.

## Расширенные возможности

### Добавление email-уведомлений

Можно настроить отправку отчетов на email через GitHub Actions.

### Интеграция с Telegram

Можно отправлять сводки в Telegram бот.

### Веб-интерфейс

Можно создать простую HTML страницу для просмотра отчетов через GitHub Pages.

## Лицензия

MIT License - используйте свободно для личных и коммерческих целей.

## Поддержка

Для вопросов и проблем создавайте Issues в репозитории.
